# MergeSort(å½’å¹¶æ’åº)

> å½’å¹¶æ’åºï¼ˆè‹±è¯­ï¼šMerge sortï¼Œæˆ–mergesortï¼‰ï¼Œæ˜¯åˆ›å»ºåœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•ï¼Œæ•ˆç‡ä¸º{\displaystyle O(n\log n)}{\displaystyle O(n\log n)}ï¼ˆå¤§Oç¬¦å·ï¼‰ã€‚1945å¹´ç”±çº¦ç¿°Â·å†¯Â·è¯ºä¼Šæ›¼é¦–æ¬¡æå‡ºã€‚è¯¥ç®—æ³•æ˜¯é‡‡ç”¨åˆ†æ²»æ³•ï¼ˆDivide and Conquerï¼‰çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨ï¼Œä¸”å„å±‚åˆ†æ²»é€’å½’å¯ä»¥åŒæ—¶è¿›è¡Œ ---------wikipedia 
> åˆ†æ²»: å°†éš¾ä»¥ç›´æ¥è§£å†³çš„å¤§è§„æ¨¡é—®é¢˜,åˆ†è§£æˆä¸€äº›å°è§„æ¨¡çš„ç›¸åŒé—®é¢˜,åˆ†è€Œæ²»ä¹‹.	
> 
> å°è§„æ¨¡é—®é¢˜å¦‚æœè¢«æˆåŠŸè§£å†³,é‚£ä¹ˆå®ƒä»¬é—´ä¸€å®šå…·æœ‰æŸç§è§„åˆ™å­˜åœ¨,æ‰¾åˆ°è¿™ç§è§„åˆ™æ˜¯è§£å†³/ä¼˜åŒ–é—®é¢˜çš„å¿…ç„¶é€”å¾„.

å½’å¹¶æ’åºæ˜¯åˆ†æ²»æ€æƒ³åœ¨æ’åºç®—æ³•ä¸Šçš„ä¸€ç§ä½“ç°

### Legand
![merge-legand](./imgs/merge.legand.gif)

### Resolve Procedure

**step1:**
å‡è®¾Kä¸ºæ•°ç»„çš„åˆ†è§£ç²’åº¦

	Array = K * SubArray 

**step2:**
å°†å­æ•°ç»„ä¾æ¬¡åˆ†è§£ç›´è‡³ä¸å¯å†åˆ†.å³:æ•°ç»„é•¿åº¦ä¸º1.

**step3:**
é€†åˆ†è§£è·¯å¾„åˆå¹¶,å¹¶ä¸”æ¯ä¸€æ¬¡çš„åˆå¹¶ä¼´éšç€æ’åºæ“ä½œ.
æ¯ä¸€æ¬¡åˆå¹¶äº§ç”Ÿçš„å­æ•°ç»„éƒ½æ˜¯æœ‰åºå­æ•°ç»„(ä¸€èˆ¬æ˜¯è‡ªå°åˆ°å¤§).

**step4:**
step3å¾—åˆ°çš„æœ€ç»ˆå€¼å°±æ˜¯éœ€è¦çš„ç»“æœ.

### Why?
å·²çŸ¥å†’æ³¡æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n^2).
ç”±æŒ‡æ•°å‡½æ•°æ›²çº¿å¯çŸ¥,æ•°æ®è§„æ¨¡nè¶Šå¤§,æ’åºç®—æ³•çš„è¿è¡Œæ—¶é—´tè¶Šå¤§,å…¶å¢é•¿ç‡ä¹Ÿè¶Šå¤§.

ä¸ºäº†å‡å°‘è¿™ç§ææ€–çš„å¢é•¿ç‡,èƒ½æƒ³åˆ°çš„æ–¹æ³•å°±æ˜¯å‡å°æ•°æ®çš„è§„æ¨¡.

é€šè¿‡åˆ†è§£æˆKç»„æ•°æ®, å°†O(n ^ 2)å˜æˆK * O((n / K)^2) + O(merge(n / K))
æˆ‘ä»¬è¿˜å¯ä»¥å¯¹æ•°æ®è§„æ¨¡næ›´è¿›ä¸€æ­¥åˆ†è§£,çŸ¥é“å…¶ä¸å¯åˆ†è§£.

æ‰€ä»¥é€‰ç”¨é€‚åˆçš„Kæˆä¸ºäº†é—®é¢˜çš„å…³é”®.

### K = ?
å·²çŸ¥ç¤¾åŒºå†…çš„å½’å¹¶æ’åºå®ç°å¤§éƒ¨åˆ†æ˜¯åŸºäºK=2çš„.ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

æˆ‘ä»¬å‡è®¾æ•°æ®è§„æ¨¡ä¸ºN, æ¯ä¸€æ¬¡çš„åˆ†ç»„ä¸ºK
å·²çŸ¥æ•°æ®è§„æ¨¡åˆ†è§£çš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªå®Œå…¨'K'å‰æ ‘
ç°å‡è®¾å…¶æ˜¯ä¸€ä¸ª**æ»¡** **å®Œå…¨** 'K'å‰æ ‘
è®¾è¿™é¢—æ•°çš„é«˜åº¦ä¸ºh,åˆ™æœ‰
$$
	K ^ h = N	
$$
$$
	h = \log_KN
$$

åˆå¹¶æ•°ç»„çš„è¿‡ç¨‹å°±æ˜¯åœ¨å­æ•°ç»„ä¸­ä¾æ¬¡å¯»æ‰¾æœ€å°å€¼çš„è¿‡ç¨‹.
å› ä¸ºåœ¨åˆå¹¶å‰,å¾…åˆå¹¶çš„å­æ•°ç»„å°±å·²ç»æ˜¯æœ‰åºçš„,æ‰€ä»¥åªè¦æ¯”è¾ƒå­æ•°ç»„çš„é¦–é¡¹å…ƒç´ çš„å¤§å°å°±å¯ä»¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹.
è®¾æ ‘çš„æ¯å±‚çš„æ¯”è¾ƒæ¬¡æ•°ä¸ºL,åœ¨ä¸è€ƒè™‘æŸä¸ªå­æ•°ç»„ä¸ºç©ºçš„æƒ…å†µä¸‹æœ‰
$$
	L = (k - 1) * (N - 1)
$$
K - 1 æ˜¯å› ä¸ºå¦‚æœæœ‰Mä¸ªæ•°å­—,æ‰¾åˆ°å…¶min/maxå€¼éœ€æ¯”è¾ƒçš„æ¬¡æ•°ä¸ºM - 1
N - 1 æ˜¯å› ä¸ºæ ‘çš„æ¯å±‚çš„æ•°æ®çš„å’Œä¸ºN,æ¯æ¬¡æˆ‘ä»¬éƒ½è¦æ‰¾æœ€å°å€¼,æ‰€ä»¥ä¼šæœ‰N - 1æ¬¡
æ‰€ä»¥æœ‰ğŸ‘†Lçš„æ¯”è¾ƒæ¬¡æ•°

âš ï¸  
éœ€è¦æ³¨æ„çš„æ˜¯ä¸Šé¢æ˜¯ç²—ç•¥çš„è®¡ç®—è¿‡ç¨‹,å› ä¸ºåœ¨å®é™…è¿‡ç¨‹ä¸­ä¸€å®šä¼šå‡ºç°æŸä¸ªæ•°ç»„å…ˆä¸ºç©ºçš„æƒ…å†µã€‚æ‰€ä»¥K - 1 æ˜¯ä¸ªçº¦å€¼.
åŒæ—¶N-1çš„å€¼ä¹Ÿæ˜¯çº¦å€¼. çœŸå€¼ä¸ºN - K ^ hth å…¶ä¸­hthä¸ºç¬¬å‡ å±‚.

æ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º
$$
	T(N) = T(N, K) = L * h = (K - 1) * (N - 1) * \log_KN
$$
æœ‰
$$
	T(N) = 	(K - 1) * (N - 1) * lgN / lgK
$$
å› ä¸ºè¿™é‡Œå¯¹Kè¿›è¡Œåˆ†æ,æ‰€ä»¥å¿½ç•¥æ•°æ®è§„æ¨¡å¸¸æ•°N
$$
	T(N) = T(K) = K - 1 / lgK
$$
å¯¹å…¶æ±‚å¯¼å¾—åˆ°æœ‰
$$
	(K * lgK - K + 1) / (K * lgK) ^ 2
$$
// TODO è¿™é‡Œå›¾ç‰‡
åœ¨[2, +âˆ)å†…æ’å¤§äº0

æ‰€ä»¥æ€»ä½“ä¸Š**K = 2**æ—¶, **æ—¶é—´å¤æ‚åº¦**æœ€å°

tips:å½“K=Næ—¶,æ ¹æ®æ’åºçš„ç­–ç•¥å…¶ä¸ºé€‰æ‹©æ’åº.
å…¶æ—¶é—´å¤æ‚åº¦ä¸º
$$
	T(N) = \log_2N * N = NlogN
$$

#### The way of implement 
å½’å¹¶æ’åºçš„å®ç°ä¸»è¦æœ‰2ç§
	- **ä¸€èˆ¬å½’å¹¶æ’åº**
		ç©ºé—´å¤æ‚åº¦O(N)
	- **åŸåœ°å½’å¹¶æ’åº**
		ç©ºé—´å¤æ‚åº¦O(1)

å…¶åŒºåˆ«æ˜¯,åŸåœ°å½’å¹¶æ’åºä¸éœ€è¦å€ŸåŠ©é¢å¤–çš„è¾…åŠ©ç©ºé—´,ç©ºé—´å¤æ‚åº¦ä¸ºO(1).

#### Part Code
ç”±ğŸ‘†æåˆ°çš„å†…å®¹,å½’å¹¶è¦æ±‚æˆ‘ä»¬è‡ªä¸Šè€Œä¸‹ä¸‹åˆ†è§£å­æ•°ç»„,ç„¶ååœ¨é€†åºåˆ†è§£è¿‡ç¨‹è¿›è¡Œæ’åºåˆå¹¶æ“ä½œ
æ‰€ä»¥å®ç°å½’å¹¶è¦ä¾èµ–æ ˆç»“æ„

ğŸ‘‡çš„å®ç°éƒ½ä¾èµ–ä¸å‡½æ•°è°ƒç”¨æ ˆ ---> é€’å½’

- **ä¸€èˆ¬å½’å¹¶**
```JavaScript
// ä¼ªä»£ç 
function merge(leftArray, rightArray) {
	const sortArray = [];
	// å¾ªç¯æ¯”è¾ƒæ‰¾åˆ°æœ€å°å€¼	
	sortArray.push(min);

	return sortArray;
}

function mergeSort(array) {
	let middleIndex; // è¿™é‡Œä½¿ç”¨ä¸­é—´ç´¢å¼•å°†æ•°ç»„åˆ‡åˆ†æˆ2ä¸ªæ•°ç»„
	let leftArray;
	let rightArray;

	if () return; // é€’å½’å‡ºå£ æ•°ç»„ä¸å¯å†åˆ†

	// ç»§ç»­åˆ†è§£æ•°ç»„
	leftArray = mergeSort(leftArray);
	rightArray = mergeSort(rightArray);

	// åˆå¹¶
	return merge(leftArray, rightArray);

	// å‡½æ•°è°ƒç”¨æ ˆä¸º
	[merge(lA, rA), merge(lAl, lAr), merge(rAl, rAr)];
}
```
å¹¶ä¸”å› ä¸ºmergeçš„å‚æ•°éƒ½æ˜¯å­mergeçš„è¿”å›å€¼,å³: 
```JavaScript
	lA = merge(lAl, lAr);
	rA = merge(rAl, rAr);
```
æ¯ä¸ªmergeå‡½æ•°ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å†…å­˜ç©ºé—´sortArrayæœ‰
```JavaScript
sortArray.length = leftArray.length + rightArray.length;
```
ä¼´éšç€æ¯æ¬¡mergeå‡½æ•°å®Œæˆå‚æ•°leftArrayå’ŒrightArrayéƒ½ä¼šè¢«JSçš„åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶æ‰.
æ‰€ä»¥åœ¨å‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æ’æœ‰é•¿åº¦ä¸ºNçš„æ•°ç»„å†…å­˜ç©ºé—´ä½œä¸ºè¾…åŠ©
å³
$$
	S(N) = N
$$

- **åŸåœ°å½’å¹¶**
åŸåœ°å½’å¹¶ä¸éœ€è¦è¾…åŠ©ç©ºé—´, è¿™æ„å‘³ç€åœ¨è¿›è¡Œ**merge**æ“ä½œå¦‚ä½•è¿›è¡Œåˆå¹¶æ˜¯è‡³å…³é‡è¦çš„

```JavaScript
// è¿™é‡Œéœ€è¦å¤šä¼ startIndex, middleIndex, endIndexé€šè¿‡ä»–ä»¬æ¥åˆ’åˆ†å­æ•°ç»„
function mergeSort(array, startIndex, endIndex) {
	... åŒä¸Š		

	mergeSort(array, startIndex, middleIndex);
	mergeSort(array, middleIndex + 1, endIndex);

	merge(array, startIndex, middleIndex, endIndex);
}

```

å…³äº**merge**æ–¹æ³•çš„å®ç°
**å°†ä¸€èˆ¬å½’å¹¶mergeæ–¹æ³•çš„æ•°ç»„pushè½¬æ¢æˆæ•°ç»„ç§»ä½çš„æ–¹å¼**
**step1**: åœ¨leftArrayä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºrightArray[0]çš„å€¼è®°ä¸ºa, å…¶ç´¢å¼•ä¸ºil
**step2**: åœ¨rightArrayä¸­å°†æ‰€æœ‰å°äºaçš„å€¼ä¾æ¬¡æ’å…¥åˆ°leftArray[il]åé¢ **è¿™æ˜¯ä¸ªæ•°ç»„ç§»ä½çš„è¿‡ç¨‹**
**step3**: åå¤step1~step2ç›´è‡³è¶Šç•Œ

å…·ä½“å¦‚ä¸‹
```
	i = startIndex
	m = middleIndex
	i         m  j         
	[1][1][3][5][2][5][7][10]
```
[1,1,3,5,2,5,7,10]è¿™ä¸ªæ•°ç»„è¢«i,m,jåˆ†æˆäº†2ä¸ªå­æ•°ç»„
leftArray = array[i ,  m]
rightArray = array(m , j]
å¹¶ä¸”ä»–ä»¬éƒ½æ˜¯æœ‰é¡ºåºçš„
è‹¥æƒ³è¦å¯¹leftArrayå’ŒrightArrayåŸå®šåˆå¹¶
**step1**
åœ¨leftArrayä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºrightArray[0]çš„å€¼
```
				i   m  j         
	[1][1][3][5][2][5][7][10]
```
è¿™æ ·array[0 , i) = [1, 1]å°±æ˜¯ä¸€ä¸ªå·²ç»æ’å¥½é¡ºåºçš„å­æ•°ç»„
**step2**
åœ¨rightArrayä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºarray[i]çš„å€¼
```
				i   m     j
	[1][1][3][5][2][5][7][10]
```
**step3**
è¿™æ—¶æˆ‘ä»¬å°†[3, 5, 2]å·¦ç§»2ä½æˆ–å³ç§»1åæœ‰
arr[0 , i + j - m - 1)ä¹Ÿæ˜¯ä¸€ä¸ªå·²ç»æ’å¥½é¡ºåºçš„å­æ•°ç»„

```
				   i   m  j
	[1][1][2][3][5][5][7][10]
```
**step4**
é‡å¤1 ï½ 3çš„è¿‡ç¨‹,å®ç°2ä¸ªæœ‰åºæ•°ç»„çš„åŸåœ°åˆå¹¶.

#### Code
[å½’å¹¶æ’åºå®ç°](https://github.com/thaloy/Algorithm/blob/master/Sort/Merge/merge.js)
[åŸåœ°å½’å¹¶å®ç°](https://github.com/thaloy/Algorithm/blob/master/Sort/Merge/mergeInPlace.js)

#### æ•°ç»„ç§»ä½
// TODO è¶…é“¾æ¥

#### å‚è€ƒ
[Cè¯­è¨€åŸåœ°å½’å¹¶å®ç°](https://blog.csdn.net/xiaolewennofollow/article/details/50896881)
